[build]
# Use all available CPU cores for compilation.
jobs = "default"

[env]
# Optional flags gated by environment variables (opt-in).
# PLATFORM_NIGHTLY_RUSTFLAGS: nightly-only parallel rustc flags (2023-11-09 blog).
#   Example: PLATFORM_NIGHTLY_RUSTFLAGS="-Z threads=0"
# PLATFORM_FAST_LINKER_RUSTFLAGS: fast linker defaults for Linux (mold or lld).
#   Example: PLATFORM_FAST_LINKER_RUSTFLAGS="-C link-arg=-fuse-ld=mold"
#   Example: PLATFORM_FAST_LINKER_RUSTFLAGS="-C link-arg=-fuse-ld=lld"
# PLATFORM_FAST_LINKER_RUSTFLAGS_DARWIN: fast linker defaults for macOS (lld or zld).
#   Example: PLATFORM_FAST_LINKER_RUSTFLAGS_DARWIN="-C link-arg=-fuse-ld=lld"
#   Example: PLATFORM_FAST_LINKER_RUSTFLAGS_DARWIN="-C link-arg=-fuse-ld=zld"
# PLATFORM_LINKER_RUSTFLAGS: explicit fast linker flags (overrides defaults).
#   Example: PLATFORM_LINKER_RUSTFLAGS="-C link-arg=-fuse-ld=mold"
#   Example: PLATFORM_LINKER_RUSTFLAGS="-C link-arg=-fuse-ld=lld"
# PLATFORM_LINKER_RUSTFLAGS_DARWIN: explicit fast linker flags for macOS.
#   Example: PLATFORM_LINKER_RUSTFLAGS_DARWIN="-C link-arg=-fuse-ld=lld"
#   Example: PLATFORM_LINKER_RUSTFLAGS_DARWIN="-C link-arg=-fuse-ld=zld"
# Fast-linker defaults are opt-in: set PLATFORM_FAST_LINKER_RUSTFLAGS
# or PLATFORM_FAST_LINKER_RUSTFLAGS_DARWIN to enable on a system
# with the desired linker installed.
PLATFORM_LINKER_RUSTFLAGS = { value = "${PLATFORM_FAST_LINKER_RUSTFLAGS}", force = false }
PLATFORM_LINKER_RUSTFLAGS_DARWIN = { value = "${PLATFORM_FAST_LINKER_RUSTFLAGS_DARWIN}", force = false }
RUSTFLAGS = { value = "${PLATFORM_NIGHTLY_RUSTFLAGS} ${PLATFORM_LINKER_RUSTFLAGS}", force = false }

[target.'cfg(target_os = "macos")'.env]
RUSTFLAGS = { value = "${PLATFORM_NIGHTLY_RUSTFLAGS} ${PLATFORM_LINKER_RUSTFLAGS_DARWIN}", force = false }